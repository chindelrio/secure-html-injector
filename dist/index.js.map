{"version":3,"file":"index.js","sources":["../src/html-injector/HtmlInjector.tsx"],"sourcesContent":["import React, { ReactNode, createElement, useCallback, useMemo } from 'react';\r\nimport DOMPurify from 'dompurify';\r\n\r\ninterface HtmlInjectorProps {\r\n  htmlString: string;\r\n}\r\nconst HtmlInjector = ({ htmlString }: HtmlInjectorProps) => {\r\n\r\n  const formatStyles = useCallback((style: string) => {\r\n    const _toCamelCase = (str: string) =>\r\n      str.replace(/-([a-z])/g, (_, char) => char.toUpperCase())\r\n    const formattedStyles: Record<string, string> = {};\r\n    style.split(';').forEach((property) => {\r\n      const [rawKey, rawValue] = property.split(':');\r\n      if (!rawKey || !rawValue) return;\r\n      const key = _toCamelCase(rawKey.trim());\r\n      const value = rawValue.trim();\r\n      if (key && value) {\r\n        formattedStyles[key] = value;\r\n      }\r\n    });\r\n    return formattedStyles;\r\n  }, []);\r\n\r\n  const domNodeToReact = useCallback((node: ChildNode): ReactNode => {\r\n    if (node.nodeType === Node.TEXT_NODE) {\r\n      return node.textContent;\r\n    }\r\n    if (node.nodeType === Node.ELEMENT_NODE) {\r\n      const el = node as Element;\r\n      const children = Array.from(el.childNodes).map(domNodeToReact);\r\n      const props: Record<string, unknown> = {};\r\n      for (const attr of Array.from(el.attributes)) {\r\n        props.key = attr.name;\r\n        if (attr.name === \"class\") {\r\n          props[\"className\"] = attr.value;\r\n        } else if (attr.name === \"style\") {\r\n          props[\"style\"] = formatStyles(attr.value);\r\n        } else if (/^on[a-z]/.test(attr.name)) {\r\n          continue;\r\n        } else {\r\n          props[attr.name] = attr.value;\r\n        }\r\n      }\r\n      return createElement(el.tagName.toLowerCase(), props, ...children);\r\n    }\r\n    return null;\r\n  }, [formatStyles]);\r\n\r\n  \r\n  const parseHtmlToReact = useCallback((stringToParse: string): ReactNode => {\r\n    const domParser = new DOMParser();\r\n    const doc = domParser.parseFromString(stringToParse, \"text/html\");\r\n    return Array.from(doc.body.childNodes).map(domNodeToReact);\r\n  }, [domNodeToReact]);\r\n\r\n  const sanitizedHtml = useMemo(() => {\r\n    if (typeof htmlString !== \"string\" || !htmlString.startsWith('<') ) return \"\";\r\n    return DOMPurify.sanitize(htmlString);\r\n  }, [htmlString]);\r\n\r\n  const parsedHtml = useMemo(() =>\r\n    sanitizedHtml.length > 0 ? parseHtmlToReact(sanitizedHtml) : null,\r\n    [sanitizedHtml, parseHtmlToReact]\r\n  );\r\n\r\n  return parsedHtml ? <div>{parsedHtml} </div> : null\r\n};\r\n\r\nexport default HtmlInjector;\r\n"],"names":["HtmlInjector","_ref","htmlString","formatStyles","useCallback","style","_toCamelCase","str","replace","_","char","toUpperCase","formattedStyles","split","forEach","property","_property$split","rawKey","rawValue","key","trim","value","domNodeToReact","node","nodeType","Node","TEXT_NODE","textContent","ELEMENT_NODE","el","children","Array","from","childNodes","map","props","_i","_Array$from","attributes","length","attr","name","test","createElement","apply","tagName","toLowerCase","concat","parseHtmlToReact","stringToParse","domParser","DOMParser","doc","parseFromString","body","sanitizedHtml","useMemo","startsWith","DOMPurify","sanitize","parsedHtml","React"],"mappings":"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"}